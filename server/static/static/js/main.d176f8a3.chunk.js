(this["webpackJsonpmeschain-client"]=this["webpackJsonpmeschain-client"]||[]).push([[0],{165:function(e,t,n){},166:function(e,t,n){"use strict";n.r(t);var s=n(0),a=n.n(s),r=n(50),o=n.n(r),c=n(56),i=n(108),l=n(107),d=n(8),j=n(12),u=n(95),h=n(167),b=n(15),f=n(5),m=n(99),y=n(53),O=n(100),x=n(22),w=n(3);var p=function(){sessionStorage.whoami&&(window.location.hash="#/");var e=Object(s.useState)(""),t=Object(j.a)(e,2),n=t[0],r=t[1],o=Object(s.useState)(1),c=Object(j.a)(o,2),i=c[0],l=c[1];return Object(w.jsx)("div",{className:"main__class",children:Object(w.jsxs)(u.a,{width:"auto",mx:"auto",my:"auto",maxWidth:"420px",bg:"#2c2c2c",color:"white",border:0,p:4,style:{boxShadow:"9px 9px 8px rgb(0 0 0)"},children:[0===i&&Object(w.jsxs)(a.a.Fragment,{children:[Object(w.jsx)(h.a,{children:"Log In to Meschain"}),Object(w.jsx)(b.a.p,{children:"If you have your keys with you go ahead and upload them"}),Object(w.jsx)(f.b,{mx:"auto",style:{display:"flex",justifyContent:"center"},children:Object(w.jsx)(m.a,{label:"Your key file",children:Object(w.jsx)(y.a,{type:"file",required:!0,accept:".meschain",placeholder:"Keys",onChange:function(e){var t=e.nativeEvent.srcElement.files[0],n=new FileReader;n.onload=function(e){sessionStorage.setItem("file",e.target.result),sessionStorage.setItem("kind",0),window.location.hash="#/setup"},n.readAsText(t)}})})}),Object(w.jsxs)(b.a.p,{style:{fontStyle:"italic"},children:["Don't have keys? Get new one"," ",Object(w.jsx)(O.a,{title:"Click here to signup",onClick:function(){return l(1)},children:"here."})]})]}),1===i&&Object(w.jsxs)(a.a.Fragment,{children:[Object(w.jsx)(h.a,{children:"SignUp for Meschain"}),Object(w.jsx)(b.a.p,{children:"No need for email or mobile. Just enter a name as you like."}),Object(w.jsxs)(f.b,{mx:"auto",children:[Object(w.jsx)(m.a,{label:"Your Name",style:{width:"100%"},children:Object(w.jsx)(y.a,{type:"text",style:{width:"100%"},value:n,onChange:function(e){return r(e.target.value)},placeholder:"eg. Superman"})}),Object(w.jsx)(x.a,{icon:"ArrowForward",iconpos:"right",onClick:function(){sessionStorage.setItem("user",n),sessionStorage.setItem("kind",1),window.location.hash="#/setup"},children:"Lets go"})]}),Object(w.jsxs)(b.a.p,{style:{fontStyle:"italic"},children:["Already have keys? Log In"," ",Object(w.jsx)(O.a,{title:"Click here to login",onClick:function(){return l(0)},children:"here."})]})]})]})})},g=n(52),v=n(168),S=n(170),k=n(172),N=n(171),C=function(){return"#".concat(Math.floor(16777215*Math.random()).toString(16))};var I=function(e){var t=e.address,n=e.lastText,a=e.name,r=e.handler,o=Object(s.useRef)();return Object(w.jsxs)(f.b,{style:{display:"flex",borderBottom:"1px solid #ded7d7",padding:"10px"},onClick:function(){r({address:t,blockie:o.current.canvas.toDataURL()})},children:[Object(w.jsx)(v.a,{style:{borderRadius:"50%"},opts:{seed:t,color:C(),bgcolor:C(),spotcolor:C()},ref:o}),Object(w.jsxs)("span",{className:"d-flex flex-column pl-2",children:[Object(w.jsx)(b.a,{fontWeight:"bold",p:0,children:a}),Object(w.jsx)("small",{children:n})]})]})};var R=function(e){var t=e.set,n=e.notifier,a=function(){return"#".concat(Math.floor(16777215*Math.random()).toString(16))},r=Object(s.useState)(!1),o=Object(j.a)(r,2),c=o[0],i=o[1],l=Object(s.useState)(""),d=Object(j.a)(l,2),u=d[0],O=d[1],p=Object(s.useState)([]),C=Object(j.a)(p,2),R=C[0],M=C[1];return Object(s.useEffect)((function(){window.peer.identity.subscribe((function(e){try{localStorage.setItem(JSON.parse(e).from,e),t(JSON.parse(e).from)}catch(n){}})),M([]),null===n||void 0===n||n.forEach((function(e){var n;e.data.to!==window.user.keyHash&&(null===(n=e.data.to)||void 0===n?void 0:n.address)!==window.user.keyHash||R.find((function(t){return t.props.address===e.data.from}))||M([].concat(Object(g.a)(R),[Object(w.jsx)(I,{name:JSON.parse(localStorage.getItem(e.data.from)).data.message.username||e.data.from,address:e.data.from,lastText:"DEFAULT TEXT",handler:t},e.data.from)]))}))}),[n]),Object(w.jsxs)("div",{children:[Object(w.jsxs)(f.b,{bg:"#2f3136",p:2,style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[Object(w.jsx)(v.a,{style:{borderRadius:"50%"},opts:{seed:sessionStorage.whoami,color:a(),bgcolor:a(),spotcolor:a()}}),Object(w.jsxs)(h.a.h6,{style:{margin:0},children:["Chats of ",window.user.userInfo.username||"Anonymous"]}),Object(w.jsxs)("span",{style:{display:"flex",alignItems:"center"},children:[Object(w.jsx)(x.a.Text,{icon:"Info",icononly:!0,size:"small",title:"Stats for Nerds",mr:2,className:"logsBTN",onClick:function(){i(!c),c?(document.querySelector(".logs").style="",document.querySelector(".chats").style="",document.querySelector(".chats").children[0].style="",document.querySelector(".chats").children[1].style=""):(document.querySelector(".logs").style="display: none",document.querySelector(".chats").style="width: 100%",document.querySelector(".chats").children[0].style="width: 35%",document.querySelector(".chats").children[1].style="width: 65%")},style:{color:"#ffffff"}}),Object(w.jsx)(x.a,{icon:"PowerSettingsNew",size:"small",iconpos:"right",onClick:function(){return window.location.reload()},children:"Log Out"})]})]}),Object(w.jsxs)(f.b,{p:2,bg:"#36393f",children:[Object(w.jsx)(b.a,{fontSize:"1",children:"Your Meschain Address"}),Object(w.jsx)(S.a,{address:sessionStorage.whoami,className:"hideQR"})]}),Object(w.jsx)(f.b,{p:2,bg:"#2f3136",children:Object(w.jsxs)(k.a,{className:"fullWidth",children:[Object(w.jsx)(m.a,{label:"Your Friends Meschain Address",children:Object(w.jsx)(y.a,{type:"text",placeholder:"Ask your friend to share their address",style:{width:"100%"},required:!0,value:u,onChange:function(e){return O(e.target.value)}})}),Object(w.jsx)(x.a,{icon:"Add",icononly:!0,ml:2,onClick:function(e){e.preventDefault();try{localStorage.getItem(u)?t(u):window.peer.privateMSG(void 0,u,"WHO")}catch(n){window.toastProvider.addMessage("Couldn't connect to your friend \ud83d\ude0c",{secondaryMessage:"May be you entered a wrong address or they are offline",colorTheme:"light",variant:"failure"})}O("")}})]})}),Object(w.jsxs)(f.b,{bg:"#46484b",style:{height:"100%",overflowY:"auto"},children:[R.map((function(e){return e})),Object(w.jsx)("div",{className:"d-flex align-items-center justify-content-center my-5 py-5",children:Object(w.jsx)("span",{children:"Your chats will appear here. Try sending a new message. \ud83d\udcdd"})})]}),Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(N.a.Provider,{ref:function(e){return window.toastProvider=e}})})]})},M=n.p+"static/media/nochat.0f4e4e0d.png";var L=function(e){var t=e.message,n=e.time,a=e.sent,r=Object(s.useRef)();return Object(w.jsx)("div",{className:a?"d-flex justify-content-end anim":"d-flex justify-content-start anim",style:{marginBottom:"4px"},ref:r,onClick:function(){r.current.children[0].children[0].classList.contains("d-none")?r.current.style.marginBottom="15px":r.current.style.marginBottom="4px",r.current.children[0].children[0].classList.toggle("d-none")},children:Object(w.jsxs)("div",{className:a?"msg_cotainer":"msg_cotainer_send",children:[t,Object(w.jsx)("span",{className:a?"msg_time d-none":"msg_time_send d-none",children:n})]})})},T=n(169);var J=function(e){var t,n=e.addr,r=function(){return"#".concat(Math.floor(16777215*Math.random()).toString(16))},o=Object(s.useState)(),c=Object(j.a)(o,2),i=c[0],l=c[1];return Object(s.useEffect)((function(){var e=["Panda","Kiwi","Mango","Doge","Dragon","Ninja","Koala","Tiger","Quokka","Bull","Chicken"];l("Anonymous "+e[Math.floor(Math.random()*e.length)])}),[n.address]),Object(w.jsxs)(a.a.Fragment,{children:[n.blockie&&Object(w.jsx)(T.a,{src:n.blockie,size:"45px"}),!n.blockie&&Object(w.jsx)(v.a,{style:{borderRadius:"50%"},opts:{seed:n.address,color:r(),bgcolor:r(),spotcolor:r()}}),Object(w.jsx)(b.a,{p:2,children:(null===(t=JSON.parse(localStorage.getItem(n.address)))||void 0===t?void 0:t.data.message.username)||i})]})};var A=function(e){var t=e.curr,n=e.notifier,r=Object(s.useState)(0),o=Object(j.a)(r,2),c=o[0],i=o[1],l=Object(s.useRef)(),d=Object(s.useState)([]),u=Object(j.a)(d,2),m=u[0],O=u[1];return Object(s.useEffect)((function(){window.peer.numConnections.subscribe((function(e){return i(e)})),console.log(t)}),[t,n]),Object(w.jsx)("div",{className:"hideChat",children:Object(w.jsxs)(f.b,{style:{height:"100%"},color:"#ffffff",children:[!t&&Object(w.jsx)(a.a.Fragment,{children:Object(w.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"inherit"},children:Object(w.jsxs)("span",{style:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",gap:"0.5rem"},children:[Object(w.jsx)("img",{src:M,width:"200"}),Object(w.jsx)(h.a.h4,{my:1,children:"It's always nice to chat with to someone"}),Object(w.jsx)(b.a,{my:0,children:"Pick a chat from the left menu, or add your friends to start a new chat."}),Object(w.jsxs)(b.a,{my:1,children:["By the way you're currently directly connected to ",Object(w.jsx)("b",{children:c})," users."]}),Object(w.jsxs)("small",{style:{marginTop:"2rem",width:"60%"},children:["All your messages are always end-to-end encrypted to never go to any server. Everything happens on a blockchain powered by people like you. ",Object(w.jsx)("wbr",{})," Meschain is built on top of blockchain where all the users compete to add your new message to the blockchain. Note that once you've sent a message it is for forever no one (not even you) can alter or delete it."]})]})})}),t&&Object(w.jsxs)(a.a.Fragment,{children:[Object(w.jsx)(f.b,{bg:"#4a4a4a",p:2,style:{display:"flex",alignItems:"center"},children:Object(w.jsx)(J,{addr:t})}),Object(w.jsxs)("div",{children:[Object(w.jsxs)("div",{class:"card-body msg_card_body",children:[Object(w.jsx)("div",{style:{display:"flex","justify-content":"center",transform:"scale(0.8)"}}),m.map((function(e){return e}))]}),Object(w.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[Object(w.jsx)(x.a.Outline,{icon:"Attachment",icononly:!0,style:{borderBottomRightRadius:0,borderTopRightRadius:0,backgroundColor:"#ffffff",marginRight:0,marginLeft:25}}),Object(w.jsx)(y.a,{type:"text",required:!0,placeholder:"Type your message...",ref:l,style:{width:"60vw",margin:"5px 0px","border-radius":0}}),Object(w.jsx)(x.a,{icon:"Send",icononly:!0,onClick:function(){var e=JSON.parse(localStorage.getItem(t.address||t)),n=l.current.value,s=e.data.message.publicKey,a=window.user.userInfo.secretKey;window.peer.broadCast(window.encrypt(s,a,n,t),"BLOCK"),O([].concat(Object(g.a)(m),[Object(w.jsx)(L,{message:n,time:"".concat((new Date).getHours(),":").concat((new Date).getMinutes()),sent:!0},n)])),l.current.value=""},style:{marginRight:"30px",borderTopLeftRadius:0,borderBottomLeftRadius:0}})]})]})]})]})})};var E=function(){var e=Object(s.useState)(void 0),t=Object(j.a)(e,2),n=t[0],a=t[1],r=Object(s.useState)(),o=Object(j.a)(r,2),c=o[0],i=o[1];return Object(s.useEffect)((function(){window.notifier.subscribe((function(e){return i(e)}))}),[]),Object(w.jsxs)("div",{className:"home",children:[Object(w.jsxs)("div",{className:"chats",children:[Object(w.jsx)(R,{set:a,notifier:c}),Object(w.jsx)(A,{curr:n,notifier:c})]}),Object(w.jsx)("div",{className:"logs"})]})};var F=function(){var e=sessionStorage.kind;return Object(s.useEffect)((function(){if(e||(window.location.hash="#/auth"),"1"===e&&(window.user=new window.User(null,null,sessionStorage.user),sessionStorage.setItem("whoami",window.user.keyHash),window.peer=new window.Peer(window.user.keyHash,window.user.whoami)),"0"===e){var t=sessionStorage.file;t||(window.location.hash="#/auth"),window.user=new window.User(JSON.parse(t).publicKey,JSON.parse(t).secretKey,JSON.parse(t).username),window.peer=new window.Peer(window.user.keyHash,window.user.whoami),window.user.keyHash!==JSON.parse(t).keyHash&&(window.location.hash="#/auth"),sessionStorage.setItem("whoami",window.user.keyHash),window.location.hash="#/"}}),[]),Object(w.jsx)("div",{className:"main__class",children:Object(w.jsxs)(u.a,{width:"auto",mx:"auto",my:"auto",maxWidth:"420px",bg:"#2c2c2c",color:"white",border:0,p:4,style:{boxShadow:"9px 9px 8px rgb(0 0 0)"},children:["1"===e&&Object(w.jsxs)(a.a.Fragment,{children:[Object(w.jsx)(h.a,{children:"Hang On"}),Object(w.jsx)(b.a.p,{children:"Download your keys and keep them at a safe private place."}),Object(w.jsxs)(f.b,{style:{display:"flex",justifyContent:"center"},children:[Object(w.jsx)(x.a.Text,{icon:"ArrowForward",iconpos:"right",style:{color:"#ffffff"},onClick:function(){return window.location.hash="#/"},children:"Continue"}),Object(w.jsx)(x.a,{mx:4,onClick:function(){var e=document.createElement("a");e.href=window.URL.createObjectURL(new Blob([JSON.stringify(window.user.userInfo)],{type:"meschain"})),e.download="key.meschain",e.click(),window.URL.revokeObjectURL(e.href)},children:"Download"})]}),Object(w.jsx)(b.a.p,{style:{fontStyle:"italic"},children:"If you loose this key their is no way of accessing your messages again."})]}),"0"===e&&Object(w.jsxs)(a.a.Fragment,{children:[Object(w.jsx)(h.a,{children:"Hang On"}),Object(w.jsx)(b.a.p,{children:"Just a moment. We're preparing your chats."}),Object(w.jsx)(b.a.p,{style:{fontStyle:"italic"},children:"You'll be redirected automatically"})]})]})})};function B(e){var t=e.component,n=Object(i.a)(e,["component"]);return Object(w.jsx)(d.b,Object(c.a)(Object(c.a)({},n),{},{render:function(e){return!0===(!!sessionStorage.whoami&&(!!window.user||(sessionStorage.clear(),!1)))?Object(w.jsx)(t,Object(c.a)({},e)):Object(w.jsx)(d.a,{to:{pathname:"/auth",state:{from:e.location}}})}}))}var H=function(){return Object(w.jsx)(l.a,{children:Object(w.jsxs)(d.d,{children:[Object(w.jsx)(d.b,{path:"/auth",component:p}),Object(w.jsx)(d.b,{path:"/setup",component:F}),Object(w.jsx)(B,{path:"/",component:E})]})})};n(165);o.a.render(Object(w.jsx)(a.a.StrictMode,{children:Object(w.jsx)(H,{})}),document.getElementById("root"))}},[[166,1,2]]]);
//# sourceMappingURL=main.d176f8a3.chunk.js.map