(this["webpackJsonpmeschain-client"]=this["webpackJsonpmeschain-client"]||[]).push([[0],{167:function(e,t,n){},168:function(e,t,n){"use strict";n.r(t);var s=n(0),a=n.n(s),o=n(51),c=n.n(o),r=n(55),i=n(110),l=n(109),d=n(8),u=n(10),j=n(96),h=n(169),b=n(15),f=n(5),m=n(100),y=n(54),O=n(101),x=n(22),g=n(3);var w=function(){sessionStorage.whoami&&(window.location.hash="#/");var e=Object(s.useState)(""),t=Object(u.a)(e,2),n=t[0],o=t[1],c=Object(s.useState)(1),r=Object(u.a)(c,2),i=r[0],l=r[1];return Object(g.jsx)("div",{className:"main__class",children:Object(g.jsxs)(j.a,{width:"auto",mx:"auto",my:"auto",maxWidth:"420px",bg:"#2c2c2c",color:"white",border:0,p:4,style:{boxShadow:"9px 9px 8px rgb(0 0 0)"},children:[0===i&&Object(g.jsxs)(a.a.Fragment,{children:[Object(g.jsx)(h.a,{children:"Log In to Meschain"}),Object(g.jsx)(b.a.p,{children:"If you have your keys with you go ahead and upload them"}),Object(g.jsx)(f.b,{mx:"auto",style:{display:"flex",justifyContent:"center"},children:Object(g.jsx)(m.a,{label:"Your key file",children:Object(g.jsx)(y.a,{type:"file",required:!0,accept:".meschain",placeholder:"Keys",onChange:function(e){var t=e.nativeEvent.srcElement.files[0],n=new FileReader;n.onload=function(e){sessionStorage.setItem("file",e.target.result),sessionStorage.setItem("kind",0),window.location.hash="#/setup"},n.readAsText(t)}})})}),Object(g.jsxs)(b.a.p,{style:{fontStyle:"italic"},children:["Don't have keys? Get new one"," ",Object(g.jsx)(O.a,{title:"Click here to signup",onClick:function(){return l(1)},children:"here."})]})]}),1===i&&Object(g.jsxs)(a.a.Fragment,{children:[Object(g.jsx)(h.a,{children:"SignUp for Meschain"}),Object(g.jsx)(b.a.p,{children:"No need for email or mobile. Just enter a name as you like."}),Object(g.jsxs)(f.b,{mx:"auto",children:[Object(g.jsx)(m.a,{label:"Your Name",style:{width:"100%"},children:Object(g.jsx)(y.a,{type:"text",style:{width:"100%"},value:n,onChange:function(e){return o(e.target.value)},placeholder:"eg. Superman"})}),Object(g.jsx)(x.a,{icon:"ArrowForward",iconpos:"right",onClick:function(){sessionStorage.setItem("user",n),sessionStorage.setItem("kind",1),window.location.hash="#/setup"},children:"Lets go"})]}),Object(g.jsxs)(b.a.p,{style:{fontStyle:"italic"},children:["Already have keys? Log In"," ",Object(g.jsx)(O.a,{title:"Click here to login",onClick:function(){return l(0)},children:"here."})]})]})]})})},p=n(26),v=n(170),S=n(172),k=n(174),N=n(173),C=function(){return"#".concat(Math.floor(16777215*Math.random()).toString(16))};var I=function(e){var t=e.address,n=e.lastText,a=e.name,o=e.handler,c=Object(s.useRef)();return Object(g.jsxs)(f.b,{style:{display:"flex",borderBottom:"1px solid #ded7d7",padding:"10px"},onClick:function(){o({address:t,blockie:c.current.canvas.toDataURL()})},children:[Object(g.jsx)(v.a,{style:{borderRadius:"50%"},opts:{seed:t,color:C(),bgcolor:C(),spotcolor:C()},ref:c}),Object(g.jsxs)("span",{className:"d-flex flex-column pl-2",children:[Object(g.jsx)(b.a,{fontWeight:"bold",p:0,children:a.slice(0,40)}),Object(g.jsx)("small",{children:n})]})]})};var M=function(e){var t=e.set,n=e.notifier,a=function(){return"#".concat(Math.floor(16777215*Math.random()).toString(16))},o=Object(s.useState)(!1),c=Object(u.a)(o,2),r=c[0],i=c[1],l=Object(s.useState)(""),d=Object(u.a)(l,2),j=d[0],O=d[1],w=Object(s.useState)([]),C=Object(u.a)(w,2),M=C[0],R=C[1];return Object(s.useEffect)((function(){window.peer.identity.subscribe((function(e){try{localStorage.setItem(JSON.parse(e).from,e),t(JSON.parse(e).from)}catch(n){}})),R([]),null===n||void 0===n||n.forEach((function(e){var n,s;e.data.to!==window.user.keyHash&&(null===(n=e.data.to)||void 0===n?void 0:n.address)!==window.user.keyHash&&e.data.from!==window.user.keyHash||M.find((function(t){return t.props.address===e.data.from}))||R([].concat(Object(p.a)(M),[Object(g.jsx)(I,{name:(null===(s=JSON.parse(localStorage.getItem(null===e||void 0===e?void 0:e.data.from)))||void 0===s?void 0:s.data.message.username)||(null===e||void 0===e?void 0:e.data.from),address:e.data.from,lastText:"New Message",handler:t},e.data.from)]))}))}),[n]),Object(g.jsxs)("div",{children:[Object(g.jsxs)(f.b,{bg:"#2f3136",p:2,style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[Object(g.jsx)(v.a,{style:{borderRadius:"50%"},opts:{seed:sessionStorage.whoami,color:a(),bgcolor:a(),spotcolor:a()}}),Object(g.jsxs)(h.a.h6,{style:{margin:0},children:["Chats of ",window.user.userInfo.username||"Anonymous"]}),Object(g.jsxs)("span",{style:{display:"flex",alignItems:"center"},children:[Object(g.jsx)(x.a.Text,{icon:"Info",icononly:!0,size:"small",title:"Stats for Nerds",mr:2,className:"logsBTN",onClick:function(){i(!r),r?(document.querySelector(".logs").style="",document.querySelector(".chats").style="",document.querySelector(".chats").children[0].style="",document.querySelector(".chats").children[1].style=""):(document.querySelector(".logs").style="display: none",document.querySelector(".chats").style="width: 100%",document.querySelector(".chats").children[0].style="width: 35%",document.querySelector(".chats").children[1].style="width: 65%")},style:{color:"#ffffff"}}),Object(g.jsx)(x.a,{icon:"PowerSettingsNew",size:"small",iconpos:"right",onClick:function(){return window.location.reload()},children:"Log Out"})]})]}),Object(g.jsxs)(f.b,{p:2,bg:"#36393f",children:[Object(g.jsx)(b.a,{fontSize:"1",children:"Your Meschain Address"}),Object(g.jsx)(S.a,{address:sessionStorage.whoami,className:"hideQR"})]}),Object(g.jsx)(f.b,{p:2,bg:"#2f3136",children:Object(g.jsxs)(k.a,{className:"fullWidth",children:[Object(g.jsx)(m.a,{label:"Your Friends Meschain Address",children:Object(g.jsx)(y.a,{type:"text",placeholder:"Ask your friend to share their address",style:{width:"100%"},required:!0,value:j,onChange:function(e){return O(e.target.value)}})}),Object(g.jsx)(x.a,{icon:"Add",icononly:!0,ml:2,onClick:function(e){e.preventDefault();try{localStorage.getItem(j)?t(j):window.peer.privateMSG(void 0,j,"WHO")}catch(n){window.toastProvider.addMessage("Couldn't connect to your friend \ud83d\ude0c",{secondaryMessage:"May be you entered a wrong address or they are offline",colorTheme:"light",variant:"failure"})}O("")}})]})}),Object(g.jsxs)(f.b,{bg:"#46484b",style:{height:"100%",overflowY:"auto"},children:[M.map((function(e){return e})),Object(g.jsx)("div",{className:"d-flex align-items-center justify-content-center my-5 py-5",children:Object(g.jsx)("span",{children:"Your chats will appear here. Try sending a new message. \ud83d\udcdd"})})]}),Object(g.jsx)(g.Fragment,{children:Object(g.jsx)(N.a.Provider,{ref:function(e){return window.toastProvider=e}})})]})},R=n.p+"static/media/nochat.0f4e4e0d.png";var L=function(e){var t=e.message,n=e.time,a=e.sent,o=Object(s.useRef)();return Object(g.jsx)("div",{className:a?"d-flex justify-content-end anim":"d-flex justify-content-start anim",style:{marginBottom:"4px"},ref:o,onClick:function(){o.current.children[0].children[0].classList.contains("d-none")?o.current.style.marginBottom="15px":o.current.style.marginBottom="4px",o.current.children[0].children[0].classList.toggle("d-none")},children:Object(g.jsxs)("div",{className:a?"msg_cotainer":"msg_cotainer_send",children:[t,Object(g.jsx)("span",{className:a?"msg_time d-none":"msg_time_send d-none",children:n})]})})},B=n(171);var D=function(e){var t,n=e.addr,o=function(){return"#".concat(Math.floor(16777215*Math.random()).toString(16))},c=Object(s.useState)(),r=Object(u.a)(c,2),i=r[0],l=r[1];return Object(s.useEffect)((function(){var e=["Panda","Kiwi","Mango","Doge","Dragon","Ninja","Koala","Tiger","Quokka","Bull","Chicken"];l("Anonymous "+e[Math.floor(Math.random()*e.length)])}),[n.address]),Object(g.jsxs)(a.a.Fragment,{children:[n.blockie&&Object(g.jsx)(B.a,{src:n.blockie,size:"45px"}),!n.blockie&&Object(g.jsx)(v.a,{style:{borderRadius:"50%"},opts:{seed:n.address,color:o(),bgcolor:o(),spotcolor:o()}}),Object(g.jsx)(b.a,{p:2,children:(null===(t=JSON.parse(localStorage.getItem(n.address)))||void 0===t?void 0:t.data.message.username)||i})]})};var H=function(e){var t=e.curr,n=(e.notifier,Object(s.useState)(0)),o=Object(u.a)(n,2),c=o[0],r=o[1],i=Object(s.useRef)(),l=Object(s.useState)([]),d=Object(u.a)(l,2),j=d[0],m=d[1];return Object(s.useEffect)((function(){var e;window.peer.numConnections.subscribe((function(e){return r(e)})),m([]),null===(e=window.notifier)||void 0===e||e.subscribe((function(e){e.forEach((function(e){var t;if(e.data.to===window.user.keyHash||(null===(t=e.data.to)||void 0===t?void 0:t.address)===window.user.keyHash){var n=window.decrypt(JSON.parse(localStorage.getItem(e.data.from)).data.message.publicKey,window.user.userInfo.secretKey,e.data);m([].concat(Object(p.a)(j),[Object(g.jsx)(L,{message:n.message,sent:!1,time:"".concat(new Date(n.timestamp).getHours(),":").concat(new Date(n.timestamp).getMinutes())})]))}}))}))}),[t]),Object(g.jsx)("div",{className:"hideChat",children:Object(g.jsxs)(f.b,{style:{height:"100%"},color:"#ffffff",children:[!t&&Object(g.jsx)(a.a.Fragment,{children:Object(g.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"inherit"},children:Object(g.jsxs)("span",{style:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",gap:"0.5rem"},children:[Object(g.jsx)("img",{src:R,width:"200"}),Object(g.jsx)(h.a.h4,{my:1,children:"It's always nice to chat with to someone"}),Object(g.jsx)(b.a,{my:0,children:"Pick a chat from the left menu, or add your friends to start a new chat."}),Object(g.jsxs)(b.a,{my:1,children:["By the way you're currently directly connected to ",Object(g.jsx)("b",{children:c})," users."]}),Object(g.jsxs)("small",{style:{marginTop:"2rem",width:"60%"},children:["All your messages are always end-to-end encrypted to never go to any server. Everything happens on a blockchain powered by people like you. ",Object(g.jsx)("wbr",{})," Meschain is built on top of blockchain where all the users compete to add your new message to the blockchain. Note that once you've sent a message it is for forever no one (not even you) can alter or delete it."]})]})})}),t&&Object(g.jsxs)(a.a.Fragment,{children:[Object(g.jsx)(f.b,{bg:"#4a4a4a",p:2,style:{display:"flex",alignItems:"center"},children:Object(g.jsx)(D,{addr:t})}),Object(g.jsxs)("div",{children:[Object(g.jsxs)("div",{class:"card-body msg_card_body",children:[Object(g.jsx)("div",{style:{display:"flex","justify-content":"center",transform:"scale(0.8)"}}),j.map((function(e){return e}))]}),Object(g.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[Object(g.jsx)(x.a.Outline,{icon:"Attachment",icononly:!0,style:{borderBottomRightRadius:0,borderTopRightRadius:0,backgroundColor:"#ffffff",marginRight:0,marginLeft:25}}),Object(g.jsx)(y.a,{type:"text",required:!0,placeholder:"Type your message...",ref:i,style:{width:"60vw",margin:"5px 0px","border-radius":0}}),Object(g.jsx)(x.a,{icon:"Send",icononly:!0,onClick:function(){var e=JSON.parse(localStorage.getItem(t.address||t)),n=i.current.value,s=e.data.message.publicKey,a=window.user.userInfo.secretKey;window.peer.broadCast(window.encrypt(s,a,n,t),"BLOCK"),i.current.value="",m([].concat(Object(p.a)(j),[Object(g.jsx)(L,{message:n,time:"".concat((new Date).getHours(),":").concat((new Date).getMinutes()),sent:!0},n)]))},style:{marginRight:"30px",borderTopLeftRadius:0,borderBottomLeftRadius:0}})]})]})]})]})})},J=n(52),T=n(108),E=n.n(T);var A=function(e){var t=e.label,n=e.type,s=e.text;return Object(g.jsxs)("div",{style:{fontSize:"0.8rem",background:"#4b4b4b",marginBottom:"0.3rem",padding:"0.6rem",display:"flex",alignItems:"center"},children:[Object(g.jsx)("span",{style:{backgroundColor:"".concat(t),borderRadius:"0.4rem",fontSize:"0.85rem",fontWeight:600,wordBreak:"keep-all",margin:"0 0.2rem",padding:"0.2rem 0.3rem",display:"flex",alignItems:"center"},children:n}),Object(g.jsx)("span",{children:s})]})};var F=function(){var e=Object(s.useState)("logs"),t=Object(u.a)(e,2),n=t[0],a=t[1],o=Object(s.useState)([]),c=Object(u.a)(o,2),r=c[0],i=c[1],l=Object(s.useState)([]),d=Object(u.a)(l,2),j=d[0],h=d[1];return Object(s.useEffect)((function(){window.notifier.subscribe((function(e){return i(e)})),window.peer.logger.subscribe((function(e){e.length>10&&h([].concat(Object(p.a)(j),[Object(g.jsx)(A,{text:e,type:"Discovery",label:"#ef7215"},e)]))})),window.minerLog.subscribe((function(e){console.log(e),h([].concat(Object(p.a)(j),[Object(g.jsx)(A,{text:e,type:"Miner",label:"#46bf14"},new Date)])),console.log(j)}))}),[]),Object(g.jsx)("div",{className:"logs",style:{borderLeft:"1px solid #eeeeee"},children:Object(g.jsxs)("div",{className:"menu",style:{height:"100vh",overflowY:"hidden"},children:[Object(g.jsxs)(f.b,{bg:"#2f3136",p:2,style:{display:"flex",justifyContent:"space-around",alignItems:"center"},children:[Object(g.jsx)("span",{className:"selector ".concat("logs"===n?"active":""),onClick:function(){return a("logs")},children:"Log"}),Object(g.jsx)("span",{className:"selector ".concat("blocks"===n?"active":""),onClick:function(){return a("blocks")},children:"Blockchain"})]}),Object(g.jsxs)(f.b,{bg:"#111111",p:2,style:Object(J.a)({display:"flex",flexDirection:"column",height:"-webkit-fill-available",wordBreak:"break-word",overflowY:"scroll"},"height","89.9%"),children:["logs"===n&&j.map((function(e){return e})),"blocks"===n&&Object(g.jsx)(E.a,{src:r,theme:"colors",name:"Blockchain",indentWidth:2,enableClipboard:!1,displayDataTypes:!1,collapsed:!0})]})]})})};var _=function(){var e=Object(s.useState)(void 0),t=Object(u.a)(e,2),n=t[0],a=t[1],o=Object(s.useState)(),c=Object(u.a)(o,2),r=c[0],i=c[1];return Object(s.useEffect)((function(){window.notifier.subscribe((function(e){return i(e)}))}),[]),Object(g.jsxs)("div",{className:"home",children:[Object(g.jsxs)("div",{className:"chats",children:[Object(g.jsx)(M,{set:a,notifier:r}),Object(g.jsx)(H,{curr:n,notifier:r})]}),Object(g.jsx)(F,{})]})};var q=function(){var e=sessionStorage.kind;return Object(s.useEffect)((function(){if(e||(window.location.hash="#/auth"),"1"===e&&(window.user=new window.User(null,null,sessionStorage.user),sessionStorage.setItem("whoami",window.user.keyHash),window.peer=new window.Peer(window.user.keyHash,window.user.whoami)),"0"===e){var t=sessionStorage.file;t||(window.location.hash="#/auth"),window.user=new window.User(JSON.parse(t).publicKey,JSON.parse(t).secretKey,JSON.parse(t).username),window.peer=new window.Peer(window.user.keyHash,window.user.whoami),window.user.keyHash!==JSON.parse(t).keyHash&&(window.location.hash="#/auth"),sessionStorage.setItem("whoami",window.user.keyHash),window.location.hash="#/"}}),[]),Object(g.jsx)("div",{className:"main__class",children:Object(g.jsxs)(j.a,{width:"auto",mx:"auto",my:"auto",maxWidth:"420px",bg:"#2c2c2c",color:"white",border:0,p:4,style:{boxShadow:"9px 9px 8px rgb(0 0 0)"},children:["1"===e&&Object(g.jsxs)(a.a.Fragment,{children:[Object(g.jsx)(h.a,{children:"Hang On"}),Object(g.jsx)(b.a.p,{children:"Download your keys and keep them at a safe private place."}),Object(g.jsxs)(f.b,{style:{display:"flex",justifyContent:"center"},children:[Object(g.jsx)(x.a.Text,{icon:"ArrowForward",iconpos:"right",style:{color:"#ffffff"},onClick:function(){return window.location.hash="#/"},children:"Continue"}),Object(g.jsx)(x.a,{mx:4,onClick:function(){var e=document.createElement("a");e.href=window.URL.createObjectURL(new Blob([JSON.stringify(window.user.userInfo)],{type:"meschain"})),e.download="key.meschain",e.click(),window.URL.revokeObjectURL(e.href)},children:"Download"})]}),Object(g.jsx)(b.a.p,{style:{fontStyle:"italic"},children:"If you loose this key their is no way of accessing your messages again."})]}),"0"===e&&Object(g.jsxs)(a.a.Fragment,{children:[Object(g.jsx)(h.a,{children:"Hang On"}),Object(g.jsx)(b.a.p,{children:"Just a moment. We're preparing your chats."}),Object(g.jsx)(b.a.p,{style:{fontStyle:"italic"},children:"You'll be redirected automatically"})]})]})})};function K(e){var t=e.component,n=Object(i.a)(e,["component"]);return Object(g.jsx)(d.b,Object(r.a)(Object(r.a)({},n),{},{render:function(e){return!0===(!!sessionStorage.whoami&&(!!window.user||(sessionStorage.clear(),!1)))?Object(g.jsx)(t,Object(r.a)({},e)):Object(g.jsx)(d.a,{to:{pathname:"/auth",state:{from:e.location}}})}}))}var Y=function(){return Object(g.jsx)(l.a,{children:Object(g.jsxs)(d.d,{children:[Object(g.jsx)(d.b,{path:"/auth",component:w}),Object(g.jsx)(d.b,{path:"/setup",component:q}),Object(g.jsx)(K,{path:"/",component:_})]})})};n(167);c.a.render(Object(g.jsx)(a.a.StrictMode,{children:Object(g.jsx)(Y,{})}),document.getElementById("root"))}},[[168,1,2]]]);
//# sourceMappingURL=main.cf83bd7f.chunk.js.map